{% extends 'base.html' %}
{% load static %}
{% block title %}
<title>Cadastro de Operaçãoes</title>
{% endblock title %}

{% block content %}
<div class="operation-form">
    <div class="main-page-form">
        <div class="header-form">
            <div class="text-header-form">
              <span>Cadastro de resultado</span>
              <p>Informações de Resultado</p>
            </div>
            <div>
                <div class="progressbar-text">
                <p>Informações Gerais</p>
                <p>Informações Operacionais parte 1</p>
                <p>Informações Operacionais parte 2</p>
                <p>Informações de Resultado</p>
                <p>Informações da Ocorrência parte 1</p>
                <p>Informações da Ocorrência parte 2</p>
                </div>
                <progress  max="100" value="60" id="progressbar"></progress>
                <ul class="progressbar">
                    <li class="progressbar-checked"></li>
                    <li class="progressbar-checked"></li>
                    <li class="progressbar-checked"></li>
                    <li></li>
                    <li></li>
                    <li></li>
                </ul>
              </div>
          </div>
        <div class="form-main">
            <form action="/" id="main-form" method="post" enctype="multipart/form-data">
                <input type="hidden" id="form_uuid" value="{{ form_uuid }}">
                <div class="input-type-checked">
                    <label for="data">Houve confronto com DAF?</label>
                        <div class="form-control" id="houve_confronto_daf" name="houve_confronto_daf" required>
                            <label> Sim</label>
                            <input type="radio" name="option-confronto" {% if operacao_info.houve_confronto_daf %}checked{% endif %}>
                            <label>Não</label>
                            <input type="radio" name="option-confronto" {% if operacao_info.houve_confronto_daf == False %}checked{% endif %}>
                        </div>
                    <label for="data">Houve resultados na operação?</label>
                    <div class="form-control" id="houve_resultados_operacao" name="houve_resultados_operacao"
                        required>
                        <label> Sim</label>
                        <input type="radio" name="option-resultados" value="1" {% if operacao_info.houve_resultados_operacao %}checked{% endif %}>
                        <label>Não</label>
                        <input type="radio" name="option-resultados" value="0" {% if operacao_info.houve_resultados_operacao == False %}checked{% endif %}>
                    </div>
                    <label for="data">Houve ocorrência na operação?</label>
                    <div class="form-control" id="houve_ocorrencia_operacao" name="houve_ocorrencia_operacao"
                        required>
                        <label> Sim</label>
                        <input type="radio" name="option-ocorrencia" value="1" {% if operacao_info.houve_ocorrencia_operacao %}checked{% endif %}>
                        <label>Não</label>
                        <input type="radio" name="option-ocorrencia" value="0" {% if operacao_info.houve_ocorrencia_operacao == False %}checked{% endif %}>
                    </div>
                </div>
            </form>
            <div class="btns-forms">
                <div class="btns-forms">
                    <a href="{% url 'operations:form-info-operation-page-two' form_uuid %}">
                        <button type="submit" class="btn-previus">Anterior</button>
                    </a>
                </div>
                <div class="btns-forms">
                        <button type="submit" class="btn-next" onclick="submitFormInfo(event);">Próximo</button>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock content %}

{% block extra_js %}
<script>
const FORWARD_URL = '/operacoes/cadastro/informacoes/ocorrencia/parte-1/';
const API_URL = '/v1/operacoes/cria-informacoes-resultado/';
const FORM_VAR_LIST = {
    "houve_confronto_daf": "#houve_confronto_daf",
    "houve_resultados_operacao": "#houve_resultados_operacao",
    "houve_ocorrencia_operacao": "#houve_ocorrencia_operacao"
};
function validateFields(formObj) {
  const fields = formObj.querySelectorAll("[required]");

  let no_errors = true;
  for (i = 0; i < fields.length; i++) {
      let inputs = fields[i].getElementsByTagName("input");
      if (!inputs[0].checked && !inputs[1].checked) {
          no_errors = false;
          fields[i].style.borderColor = "#ED0606";
      }else {
          fields[i].style.borderColor = "#0676ED";
      }
  }
  return no_errors;
}

function buildFormData(fields){
    let formData = {};
    Object.entries(fields).forEach(field => {
        let fieldObj = document.querySelector(field[1]);
        let inputs = fieldObj.getElementsByTagName("input");
        if(inputs[0].checked){
            formData[field[0]] = 1;
        }else if (inputs[1].checked){
            formData[field[0]] = 0;
        }
    });
    return JSON.stringify(formData);
}
</script>
{% endblock extra_js %}